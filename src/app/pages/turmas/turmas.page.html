<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-button *ngIf="selectedTurma" (click)="backToList()" fill="clear" class="custom-back-btn">
        <ion-icon slot="icon-only" name="chevron-back"></ion-icon>
      </ion-button>
    </ion-buttons>
    <ion-buttons slot="start" *ngIf="!selectedTurma"> <!-- Verifica√ß√£o para que s√≥ exista o bot√£o de menu se nenhuma turma for selecionada -->
      <ion-menu-button class="menu-button-externo"></ion-menu-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>

<ion-content>
  <div class="container">
    <div *ngIf="!selectedTurma">
      <div class="search">
        <input placeholder="Pesquise a turma:" [(ngModel)]="query" />  
      </div>
      <div class="grid">
        <div class="card" *ngFor="let t of filteredTurmas()" (click)="selectTurma(t)">
          <div class="avatar">üë§</div>
          <div class="id">{{ t.id }}</div>
        </div>
      </div>
    </div>

    <div *ngIf="selectedTurma">
      <div class="turma-header">
        <h2>Turma ({{ selectedTurma.id }})</h2>
        <button class="edit-btn" (click)="editarNomeTurma()">‚úèÔ∏è Editar</button>
      </div>

      <div class="search">
        <input placeholder="Pesquisar aluno:" />
      </div>

      <div class="grid students">
        <div class="card student" *ngFor="let s of studentsByTurma[selectedTurma.id]" (click)="abrirRegistroAluno(s)">
          <img [src]="s.avatar" class="avatar-img" />
          <div class="name">{{ s.name }}</div>
          <button class="falta" [class.on]="s.falta" (click)="toggleFalta(s, $event)"></button>
        </div>
      </div>
    </div>

    <div class="modal-overlay" *ngIf="showEditModal" (click)="fecharModal()">
      <div class="modal-content" (click)="$event.stopPropagation()">
        <h3>Editar Nome da Turma</h3>
        <input type="text" [(ngModel)]="novoNomeTurma" placeholder="Digite o novo nome" />
        <div class="modal-buttons">
          <button class="btn-cancelar" (click)="fecharModal()">Cancelar</button>
          <button class="btn-salvar" (click)="salvarNomeTurma()">Salvar</button>
        </div>
      </div>
    </div>

    <div class="modal-overlay" *ngIf="showAlunoModal" (click)="fecharAlunoModal()">
      <div class="modal-content modal-aluno" (click)="$event.stopPropagation()">
        <h3>{{ alunoSelecionado?.name }}</h3>
        <div class="registro-item">
          <label>Alimenta√ß√£o:</label>
          <select [(ngModel)]="alunoSelecionado.alimentacao">
            <option value="√ìtimo">√ìtimo</option>
            <option value="Bom">Bom</option>
            <option value="Regular">Regular</option>
            <option value="Ruim">Ruim</option>
          </select>
        </div>
        <div class="registro-item">
          <label>Comportamento:</label>
          <select [(ngModel)]="alunoSelecionado.comportamento">
            <option value="√ìtimo">√ìtimo</option>
            <option value="Bom">Bom</option>
            <option value="Regular">Regular</option>
            <option value="Ruim">Ruim</option>
          </select>
        </div>
        <div class="registro-item">
          <label>Presen√ßa:</label>
          <select [(ngModel)]="alunoSelecionado.presenca">
            <option value="Presente">Presente</option>
            <option value="Ausente">Ausente</option>
          </select>
        </div>
        <div class="modal-buttons">
          <button class="btn-cancelar" (click)="fecharAlunoModal()">Cancelar</button>
          <button class="btn-salvar" (click)="salvarRegistroAluno()">Salvar</button>
        </div>
      </div>
    </div>
  </div>
</ion-content>
